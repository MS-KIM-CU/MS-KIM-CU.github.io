---
title: "Instacart Grocery Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(plotly)
library(p8105.datasets)

# Load and sample data
data("instacart")
instacart_sample <- instacart |> 
  sample_n(10000) |>  # Random sample
  filter(!is.na(department))  # Remove NA values
```

## Scatterplot {data-width=600}

```{r}
plot_ly(instacart_sample, 
        x = ~order_hour_of_day, 
        y = ~order_number, 
        type = "scatter", 
        mode = "markers",
        color = ~department, 
        alpha = 0.6) |> 
  layout(title = "Order Hour vs. Order Number by Aisle",
         xaxis = list(title = "Hour of Day (0-23)"),
         yaxis = list(title = "Order Sequence Number"),
         legend = list(title = list(text = "Department")))
```
The above scatterplot shows the relationship between the hour of the day orders are placed and the sequence number of the order for each user. We can find some patterns, such as increased order activity in certain departments during peak hours.

## Bar Plot {data-width=400}

```{r}
top_aisles <- instacart_sample |> 
  count(aisle) |> 
  top_n(10, n) |> 
  mutate(aisle = fct_reorder(aisle, n))

plot_ly(top_aisles, 
        x = ~aisle, 
        y = ~n, 
        type = "bar", 
        color = ~aisle,
        showlegend = FALSE) |> 
  layout(title = "Top 10 Aisles Based on Count of Orders",
         xaxis = list(title = "Name of Aisle", tickangle = -45),
         yaxis = list(title = "Number of Orders"))
```
The bar plot shoss the top 10 aisles with the most orders in the sampled Instacart dataset. It highlights the two most popular categories are fresh fruits and fresh vegetables.

## Boxplot {data-width=600}

```{r}
plot_ly(instacart_sample, 
        y = ~add_to_cart_order, 
        type = "box", 
        color = ~department,
        boxpoints = "outliers") |> 
  layout(title = "Add-to-Cart Distribution Across Departments",
         yaxis = list(title = "Position in Cart (1 = First Added)"),
         xaxis = list(title = "Department"),
         showlegend = TRUE)
```
The box plot displays the distribution of product addition in the shopping cart across different departments. It reveals medians, quartiles, and outliers, showing how early or late each department's items are added.
